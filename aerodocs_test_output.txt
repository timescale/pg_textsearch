psql:test/sql/aerodocs.sql:7: NOTICE:  extension "tapir" already exists, skipping
CREATE EXTENSION
Testing tapir with sample aerodynamics documents...
CREATE TABLE
CREATE TABLE
CREATE TABLE
Loading substantial subset of real Cranfield documents for testing...
INSERT 0 10
INSERT 0 3
INSERT 0 3
psql:test/sql/aerodocs.sql:68: NOTICE:  Tapir index build started for relation cranfield_tapir_idx
psql:test/sql/aerodocs.sql:68: NOTICE:  Using text search configuration: english
psql:test/sql/aerodocs.sql:68: NOTICE:  Using index options: k1=1.20, b=0.75
psql:test/sql/aerodocs.sql:68: NOTICE:  Tapir index build completed: 10 documents, avg_length=87.80, text_config='english' (k1=1.20, b=0.75)
CREATE INDEX
tapir index created. Running validation tests...
SET
Test 1: Basic search with <@> operator
psql:test/sql/aerodocs.sql:83: WARNING:  DEBUG: match_pathkeys_to_index: checking index cranfield_tapir_idx with 1 pathkeys
psql:test/sql/aerodocs.sql:83: WARNING:  DEBUG: match_clause_to_ordering_op: indexcol=0, pk_opfamily=1970
psql:test/sql/aerodocs.sql:83: WARNING:  DEBUG: match_pathkeys_to_index: found match for indexcol 0
psql:test/sql/aerodocs.sql:83: WARNING:  DEBUG: After match_pathkeys_to_index: orderbyclauses length=1, orderbyclausecols length=1
psql:test/sql/aerodocs.sql:83: WARNING:  DEBUG: About to create_index_path: index_clauses=0, orderbyclauses=1, useful_pathkeys=1
psql:test/sql/aerodocs.sql:83: WARNING:  Tapir costestimate: startup=0.010000, total=0.157500, selectivity=0.100000, pages=1.000000, num_tuples=10.000000
psql:test/sql/aerodocs.sql:83: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:83: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:83: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:83: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:83: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:83: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:83: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:83: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:83: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:83: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
 doc_id |                        title_preview                         | score
--------+--------------------------------------------------------------+--------
      6 | one-dimensional transient heat flow in a multilayer slab .   | 0.0000
      9 | transition studies and skin friction measurements on an insu | 0.0000
      7 | the effect of controlled three-dimensional roughness on boun | 0.0000
      2 | simple shear flow past a flat plate in an incompressible flu | 0.0000
      1 | experimental investigation of the aerodynamics of a wing in  | 0.0000
(5 rows)

Test 2: Multi-term search
psql:test/sql/aerodocs.sql:93: WARNING:  DEBUG: match_pathkeys_to_index: checking index cranfield_tapir_idx with 1 pathkeys
psql:test/sql/aerodocs.sql:93: WARNING:  DEBUG: match_clause_to_ordering_op: indexcol=0, pk_opfamily=1970
psql:test/sql/aerodocs.sql:93: WARNING:  DEBUG: match_pathkeys_to_index: found match for indexcol 0
psql:test/sql/aerodocs.sql:93: WARNING:  DEBUG: After match_pathkeys_to_index: orderbyclauses length=1, orderbyclausecols length=1
psql:test/sql/aerodocs.sql:93: WARNING:  DEBUG: About to create_index_path: index_clauses=0, orderbyclauses=1, useful_pathkeys=1
psql:test/sql/aerodocs.sql:93: WARNING:  Tapir costestimate: startup=0.010000, total=0.157500, selectivity=0.100000, pages=1.000000, num_tuples=10.000000
psql:test/sql/aerodocs.sql:93: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:93: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:93: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:93: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:93: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:93: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:93: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:93: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:93: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:93: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
 doc_id |                        title_preview                         | score
--------+--------------------------------------------------------------+--------
      6 | one-dimensional transient heat flow in a multilayer slab .   | 0.0000
      8 | measurements of the effect of two-dimensional and three-dime | 0.0000
      2 | simple shear flow past a flat plate in an incompressible flu | 0.0000
      7 | the effect of controlled three-dimensional roughness on boun | 0.0000
      9 | transition studies and skin friction measurements on an insu | 0.0000
(5 rows)

Test 3: Validation against Cranfield reference results
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: About to create_index_path: index_clauses=1, orderbyclauses=0, useful_pathkeys=0
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: About to create_index_path: index_clauses=1, orderbyclauses=0, useful_pathkeys=0
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: match_pathkeys_to_index: checking index cranfield_tapir_idx with 1 pathkeys
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: match_clause_to_ordering_op: indexcol=0, pk_opfamily=1970
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: match_pathkeys_to_index: found match for indexcol 0
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: After match_pathkeys_to_index: orderbyclauses length=1, orderbyclausecols length=1
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: About to create_index_path: index_clauses=0, orderbyclauses=1, useful_pathkeys=1
psql:test/sql/aerodocs.sql:122: WARNING:  Tapir costestimate: startup=0.012500, total=0.157750, selectivity=0.100000, pages=1.000000, num_tuples=10.000000
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: About to create_index_path: index_clauses=1, orderbyclauses=0, useful_pathkeys=0
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: match_pathkeys_to_index: checking index cranfield_tapir_idx with 1 pathkeys
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: match_pathkeys_to_index: no match found for pathkey
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: After match_pathkeys_to_index: orderbyclauses length=0, orderbyclausecols length=0
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: About to create_index_path: index_clauses=0, orderbyclauses=0, useful_pathkeys=1
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: About to create_index_path: index_clauses=1, orderbyclauses=0, useful_pathkeys=1
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: About to create_index_path: index_clauses=1, orderbyclauses=0, useful_pathkeys=1
psql:test/sql/aerodocs.sql:122: WARNING:  DEBUG: About to create_index_path: index_clauses=2, orderbyclauses=0, useful_pathkeys=1
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:122: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
        query_text         | doc_id | tapir_rank | expected_rank | actual_score | expected_score |                   title_preview
---------------------------+--------+------------+---------------+--------------+----------------+----------------------------------------------------
 aerodynamic flow analysis |      6 |          1 |               |       0.0000 |                | one-dimensional transient heat flow in a multilaye
 aerodynamic flow analysis |      3 |          2 |             2 |       0.0000 |         1.2000 | the boundary layer in simple shear flow past a fla
 aerodynamic flow analysis |      9 |          3 |               |       0.0000 |                | transition studies and skin friction measurements
 aerodynamic flow analysis |      7 |          4 |               |       0.0000 |                | the effect of controlled three-dimensional roughne
 aerodynamic flow analysis |      4 |          5 |             3 |       0.0000 |         1.0000 | approximate solutions of the incompressible lamina
 aerodynamic flow analysis |      2 |          6 |               |       0.0000 |                | simple shear flow past a flat plate in an incompre
 aerodynamic flow analysis |      5 |          7 |               |       0.0000 |                | one-dimensional transient heat conduction into a d
 aerodynamic flow analysis |      1 |          8 |             1 |       0.0000 |         1.5000 | experimental investigation of the aerodynamics of
 aerodynamic flow analysis |     10 |          9 |               |       0.0000 |                | the theory of the impact tube at low pressure .
(9 rows)

Test 4: Performance test with top-k search
psql:test/sql/aerodocs.sql:135: WARNING:  DEBUG: About to create_index_path: index_clauses=1, orderbyclauses=0, useful_pathkeys=1
psql:test/sql/aerodocs.sql:135: WARNING:  DEBUG: match_pathkeys_to_index: checking index cranfield_tapir_idx with 1 pathkeys
psql:test/sql/aerodocs.sql:135: WARNING:  DEBUG: match_pathkeys_to_index: no match found for pathkey
psql:test/sql/aerodocs.sql:135: WARNING:  DEBUG: After match_pathkeys_to_index: orderbyclauses length=0, orderbyclausecols length=0
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
psql:test/sql/aerodocs.sql:135: WARNING:  text <@> tpquery operator called without index name - returning 0.0
HINT:  Use to_tpquery(text, index_name) for standalone scoring
 query_id |        query_preview         | total_docs | matching_docs
----------+------------------------------+------------+---------------
        1 | aerodynamic flow analysis... |         10 |             0
        2 | boundary layer turbulent...  |         10 |             0
        3 | wing design optimization...  |         10 |             0
(3 rows)

Test 5: Verify index usage with EXPLAIN
SET
psql:test/sql/aerodocs.sql:144: WARNING:  DEBUG: match_pathkeys_to_index: checking index cranfield_tapir_idx with 1 pathkeys
psql:test/sql/aerodocs.sql:144: WARNING:  DEBUG: match_clause_to_ordering_op: indexcol=0, pk_opfamily=1970
psql:test/sql/aerodocs.sql:144: WARNING:  DEBUG: match_pathkeys_to_index: found match for indexcol 0
psql:test/sql/aerodocs.sql:144: WARNING:  DEBUG: After match_pathkeys_to_index: orderbyclauses length=1, orderbyclausecols length=1
psql:test/sql/aerodocs.sql:144: WARNING:  DEBUG: About to create_index_path: index_clauses=0, orderbyclauses=1, useful_pathkeys=1
psql:test/sql/aerodocs.sql:144: WARNING:  Tapir costestimate: startup=0.010000, total=0.157500, selectivity=0.100000, pages=1.000000, num_tuples=10.000000
                                              QUERY PLAN
------------------------------------------------------------------------------------------------------
 Limit  (cost=0.01..1.77 rows=10 width=44)
   ->  Index Scan using cranfield_tapir_idx on aerodocs_documents  (cost=0.01..1.77 rows=10 width=44)
         Order By: (full_text <@> 'supersonic aircraft design'::tpquery)
(3 rows)

SET
Cranfield tapir validation completed successfully.
All tests demonstrate proper tapir functionality with the <@> operator.
DROP TABLE
DROP TABLE
DROP TABLE
